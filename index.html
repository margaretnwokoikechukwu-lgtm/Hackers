<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HACKERS - Code War</title>

<style>
body{
    margin:0;
    font-family:'Courier New', monospace;
    background:linear-gradient(135deg,#000814,#001d3d);
    color:#00f5d4;
}

#matrixCanvas{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    z-index:-1;
}

h1{
    text-align:center;
    padding:15px;
    text-shadow:0 0 10px #00f5d4;
}

.panel{
    background:#001d3d;
    border:1px solid #00f5d4;
    border-radius:12px;
    padding:15px;
    margin:10px;
    box-shadow:0 0 15px #00f5d4;
}

input,select{
    width:100%;
    padding:10px;
    margin:5px 0;
    background:#000814;
    border:1px solid #00f5d4;
    color:#00f5d4;
    border-radius:8px;
}

button{
    width:100%;
    padding:12px;
    margin-top:10px;
    background:#00f5d4;
    color:#000;
    font-weight:bold;
    border:none;
    border-radius:8px;
    cursor:pointer;
}

.dashboard{
    display:flex;
    justify-content:space-around;
    flex-wrap:wrap;
}

.statBox{
    background:#000814;
    padding:10px;
    margin:5px;
    border-radius:8px;
    border:1px solid #00f5d4;
    text-align:center;
    flex:1;
}

.log{
    height:200px;
    overflow-y:auto;
    background:#000814;
    padding:10px;
    border-radius:8px;
    font-size:13px;
}

.hidden{display:none;}
</style>
</head>

<body>

<canvas id="matrixCanvas"></canvas>

<h1>HACKERS - CODE WAR</h1>
<div style="text-align:center; margin-bottom:15px;">
    <button onclick="window.location.href='hackers_v2.html'">
        ▶ Play Upgraded Version (v2)
    </button>
</div>
<div class="panel" id="setupPanel">
<select id="difficulty">
<option value="easy">Easy</option>
<option value="normal">Normal</option>
<option value="hard">Hard</option>
</select>

<input type="password" id="playerSecret" placeholder="Enter Your 4 Digit Secret">
<button onclick="startGame()">Start Battle</button>
</div>

<div id="gamePanel" class="hidden">

<div class="panel dashboard">
<div class="statBox">Turn<br><span id="turnIndicator">YOU</span></div>
<div class="statBox">Round<br><span id="round">1</span></div>
<div class="statBox">You<br><span id="playerScore">0</span></div>
<div class="statBox">Computer<br><span id="computerScore">0</span></div>
</div>

<div class="panel">
<h3>Your Turn</h3>
<input id="playerGuess" placeholder="Enter Guess">
<button onclick="playerTurn()">Attack</button>
</div>

<div class="panel">
<h3>Computer Turn</h3>
<div id="computerGuessDisplay">Waiting...</div>
<input id="deadInput" placeholder="Dead">
<input id="injuredInput" placeholder="Injured">
<button onclick="computerTurn()">Submit Result</button>
</div>

<div class="panel">
<h3>Battle Log</h3>
<div class="log" id="log"></div>
</div>

<button onclick="resetGame()">Reset Game</button>

</div>

<script>

// MATRIX BACKGROUND
let canvas=document.getElementById("matrixCanvas");
let ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let letters="01".split("");
let fontSize=14;
let columns=canvas.width/fontSize;
let drops=[];
for(let x=0;x<columns;x++) drops[x]=1;

function drawMatrix(){
ctx.fillStyle="rgba(0,0,0,0.05)";
ctx.fillRect(0,0,canvas.width,canvas.height);
ctx.fillStyle="#00f5d4";
ctx.font=fontSize+"px monospace";

for(let i=0;i<drops.length;i++){
let text=letters[Math.floor(Math.random()*letters.length)];
ctx.fillText(text,i*fontSize,drops[i]*fontSize);
if(drops[i]*fontSize>canvas.height && Math.random()>0.975) drops[i]=0;
drops[i]++;
}
}
setInterval(drawMatrix,33);

// GAME LOGIC
let playerSecret="";
let computerSecret="";
let difficulty="";
let round=1;
let playerScore=0;
let computerScore=0;
let computerGuess="";

function startGame(){
playerSecret=document.getElementById("playerSecret").value;
difficulty=document.getElementById("difficulty").value;

if(!validCode(playerSecret)){
alert("Invalid Secret Code");
return;
}

computerSecret=generateCode();

document.getElementById("setupPanel").classList.add("hidden");
document.getElementById("gamePanel").classList.remove("hidden");

log("Battle Started - "+difficulty.toUpperCase());
}

function validCode(code){
return code.length===4 &&
new Set(code).size===4 &&
/^\d+$/.test(code);
}

function generateCode(){
let digits="0123456789";
let result="";
while(result.length<4){
let r=digits[Math.floor(Math.random()*10)];
if(!result.includes(r)) result+=r;
}
return result;
}

function calculateResult(secret,guess){
let dead=0,injured=0;
for(let i=0;i<4;i++){
if(guess[i]===secret[i]) dead++;
else if(secret.includes(guess[i])) injured++;
}
return {dead,injured};
}

function playerTurn(){
let guess=document.getElementById("playerGuess").value;
if(!validCode(guess)){
alert("Invalid Guess");
return;
}

let result=calculateResult(computerSecret,guess);
log("YOU → "+guess+" | "+result.dead+"D "+result.injured+"I");

if(result.dead===4){
playerScore++;
updateStats();
log("YOU WIN ROUND!");
return;
}

computerPlay();
}

function computerPlay(){
computerGuess=generateCode();
document.getElementById("computerGuessDisplay").innerText=
"Computer attacks: "+computerGuess;
}

function computerTurn(){
let dead=parseInt(document.getElementById("deadInput").value);
let injured=parseInt(document.getElementById("injuredInput").value);

if(isNaN(dead)||isNaN(injured)){
alert("Enter valid result");
return;
}

log("CPU → "+computerGuess+" | "+dead+"D "+injured+"I");

if(dead===4){
computerScore++;
updateStats();
log("COMPUTER WINS ROUND!");
return;
}

round++;
updateStats();
}

function updateStats(){
document.getElementById("round").innerText=round;
document.getElementById("playerScore").innerText=playerScore;
document.getElementById("computerScore").innerText=computerScore;
}

function resetGame(){
location.reload();
}

function log(text){
let logDiv=document.getElementById("log");
logDiv.innerHTML+=text+"<br>";
logDiv.scrollTop=logDiv.scrollHeight;
}

</script>

</body>
</html>